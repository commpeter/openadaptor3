<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<!--
    This adaptor does the following...
    
      * reads data from stdin
      * invokes a webservice with the data
    
    It is designed to illustrate the basic structure of an adaptor that processes
    data by calling a webservice.

    Run it like this...
    
      java org.openadaptor.spring.SpringApplication -config wsinvoker.xml -bean Adaptor
    
    You need the following in your classpath
  
      lib
      lib/openadaptor.jar
      lib/openadaptor-spring.jar
      lib/openadaptor-depends.jar
      lib/3rdparty/activation.jar
     
    Once it is running you need to type some data into the command line, for the
    processing to succeed, the webservice it is connecting to needs to be running
    (see the adaptorws.xml example).
-->

<beans>
 
  <bean id="Adaptor" class="org.openadaptor.core.adaptor.Adaptor">
   <property name="messageProcessor"><ref bean="Pipeline"/></property>
  </bean>
  
  <bean id="Pipeline" class="org.openadaptor.core.router.Pipeline">
    <description>
      This creates the simple pipeline Reader-WebService
    </description>
    <property name="processors">
      <list>
        <ref bean="Reader"/>
        <ref bean="WebService"/>
      </list>
    </property>
  </bean>

  <bean id="Reader" class="org.openadaptor.auxil.connector.iostream.reader.StreamReadConnector">
    <property name="streamReader">
      <bean class="org.openadaptor.auxil.connector.iostream.reader.FileReader"/>
    </property>
    <property name="recordReader">
      <bean class="org.openadaptor.auxil.connector.iostream.reader.StringRecordReader"/>
    </property>
  </bean>
  
  <!-- this is a write connector that invokes a webservice -->
  <bean id="WebService" class="org.openadaptor.auxil.connector.soap.WebServiceWriteConnector">
    <property name="endpoint" value="http://localhost:9999/MyService?wsdl"/>
    <property name="methodName" value="process"/>
  </bean>
  
</beans>